<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"
      vocab="http://schema.org/" typeof="Blog">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>zeitkraut – Avoid Mail Harvesting through Address Munging</title>
    <link rel="canonical" href="https://zeitkraut.de/posts/2013-08-25-avoiding-spam.html" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/svg+xml" href="/img/zeitlens-logo-default.svg" />
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="/css/zeitlens.css" />
    <link rel="author"     href="/contact.html#albertkrewinkel" />
    <link property="image" href="/img/zeitlens-logo-default.svg" />
    <link rel="apple-touch-icon" href="/img/zeitlens-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/img/zeitlens-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/img/zeitlens-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/img/zeitlens-icon-144x144.png" />
    <link rel="alternate"  href="/atom.xml" title="ATOM"
          type="application/atom+xml" />
    <script type="text/javascript" async="async" src="/scripts/zeitlens.js"></script>
  </head>
  <body>
    <div id="wrap">
      <div id="header">

        <nav id="navbar" class="navbar navbar-fixed-top" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-exl-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="fa fa-bars"></span>
              </button>
              <a href="/">
                <div class="navbar-brand">
                  <!-- ZeitKraut logo -->
                  <div class="logo inline-logo" id="brand-logo"><svg viewBox="0 0 212 212"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    
  </defs>
  <rect class="logo-background"
        width="100%"
        height="100%" />
  <g transform="translate(100 100)">
    <!-- hours -->
    <g class="logo-hour-dial" transform="rotate(310)">
      <rect class="dial"
            x="-11"
            y="-50"
            width="22"
            height="50"
            ry="16px"/>
    </g>
    <!-- minutes -->
    <g class="logo-minute-dial" transform="rotate(60)">
      <rect class="dial"
            x="-10"
            y="-70"
            width="20"
            height="70"
            ry="14px"/>
    </g>
    <!-- seconds -->
    <g class="logo-second-dial" transform="rotate(200)">
      <circle class="centerpiece"
              cx="0"
              cy="0"
              r="2"/>
      <rect class="dial"
            x="-2"
            y="-73"
            width="4"
            height="73"
            ry="5px"/>
    </g>
    <!-- clock center -->
    <circle class="logo-centerpiece"
            cx="0"
            cy="0"
            r="15"/>
  </g>
  <g class="logo-lupe"
     transform="translate(100 100) rotate(45)">
    <!-- lens -->
    <circle class="logo-lens"
            cx="0"
            cy="0"
            r="86"
            fill="none"
            stroke-width="26px" />
    <!-- handle -->
    <rect class="logo-handle"
          x="90"
          y="-30px"
          width="40"
          height="60px"
          rx="5px"/>
  </g>
  
</svg>
</div>
                  zeitkraut
                </div>
              </a>
            </div>
            <div class="collapse navbar-collapse navbar-exl-collapse">
              <ul class="nav navbar-nav navbar-right">
                <li><a href="/archive.html">Archive</a></li>
                <li><a href="/tags.html">Tags</a></li>
                <li><a href="/colophon.html">Colophon</a></li>
                <li><a href="/privacy-policy.html">Privacy Policy</a></li>
              </ul>
            </div>
          </div>
        </nav>

        <div id="headerImageContainer">
          <img id="headerImg" src="/img/header_400x129.jpg" class="img-responsive" alt="" />
        </div>
      </div>

      <div id="content" class="container">
        <article vocab="http://schema.org/" typeof="BlogPosting">
  <h1 property="headline">Avoid Mail Harvesting through Address Munging</h1>

  <div class="post-metadata">
    <div class="post-date">
      <time datetime="2013-08-25" property="datePublished">August 25, 2013</time>
    </div>
    <div class="post-tags">tagged with: <a href="/tags/spam.html">spam</a>, <a href="/tags/address-munging.html">address-munging</a>, <a href="/tags/html.html">html</a>, <a href="/tags/css.html">css</a>, <a href="/tags/javascript.html">javascript</a></div>
  </div>

  <div property="articleBody">
    <p>Spam just doesn’t die. Every major mail provider has really good spam filters in place, as do the common mail clients. Nontheless, there seem to be enough people reading – and acting on – spam mail to make it a profitable business. No matter how much we hate it, we need to deal with spam.</p>
<p>Better than having a good spam filter is not to be spammed in the first place. Since nobody can sent me unsolicited bulk mail if they don’t know my mail address, keeping the mail address as private as possible is the way to go here. But what if we <em>want</em> our e-mail address to be public for other people to reach us? Adding minor obstacles to make it just a bit more difficult for spammers to get the address can be enough.</p>
<h2 id="address-munging">Address Munging</h2>
<p>The usual way for spammers to collect email addresses is to crawl websites and to harvest everything that looks like a valid mail address. A common defense is <a href="https://en.wikipedia.org/wiki/Address_munging">address munging</a>, i.e. resolving to bogus comments, additional markup, images or javascript to hide mail addresses from automatic harvesters. I find the use of images or javascript problematic for various reasons and just dislike unnecessary comments. Luckily, <abbr class="initialism" title="Hypertext Markup Language, fifth revision">HTML5</abbr> and <abbr class="initialism" title="Cascading Style Sheets, third revision">CSS3</abbr> make it really easy to mangle addresses without using either of these methods.</p>
<h2 id="obfuscating-an-address-with-html5-css3">Obfuscating an Address with HTML5 &amp; CSS3</h2>
<p>Our approach here leverages the <abbr class="initialism" title="Hypertext Markup Language, fifth revision">HTML5</abbr> <a href="http://www.w3.org/TR/html5/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes"><code>data-*</code></a> attributes as well as the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::before"><code>::before</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::after"><code>::after</code></a> pseudo-elements. The mail address is divided and stored in custom data attributes and displayed as pseudo-elements. The address is kept in the markup, the presentation is handled in the style sheet:</p>
<p>HTML:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">&lt;span</span><span class="ot"> data-user=</span><span class="st">&quot;john.doe&quot;</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="ot">      data-domain=</span><span class="st">&quot;example.com&quot;</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="ot">      class=</span><span class="st">&quot;obfuscated-mail-address&quot;</span><span class="kw">&gt;</span><span class="co">&lt;!--</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">--&gt;</span>@<span class="kw">&lt;span&gt;</span>obfuscated email address<span class="kw">&lt;/span&gt;&lt;/span&gt;</span></a></code></pre></div>
<p>CSS:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="fu">.obfuscated-mail-address</span><span class="in">::before</span> {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="kw">content</span>: <span class="fu">attr</span>(data-user);</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="fu">.obfuscated-mail-address</span><span class="in">::after</span> {</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="kw">content</span>: <span class="fu">attr</span>(data-domain);</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="fu">.obfuscated-email-address</span> &gt; * {</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="kw">display</span>: <span class="dv">none</span>;</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">}</a></code></pre></div>
<p>The result is readable, but can be neither selected nor copied:</p>
<p><span class="obfuscated-mail-address dont-touch" data-user="john.doe" data-domain="example.com"><!--
--><span>obfuscated email address</span></span></p>
<p>The nested <code>&lt;span&gt;</code> and its styling could be omitted, without changing the presentation in most browsers. We use it to ensures that everything fails gracefully in browsers with limited <abbr class="initialism" title="Cascading Style Sheets">CSS</abbr> support. To see why this matters, have a look at this page in a text browser like <em>w3m</em> or <em>links</em>.</p>
<h2 id="drawbacks">Drawbacks</h2>
<p>The biggest advantage of this method is also it’s biggest disadvantage: The semantics are broken. The classic markup-code</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;mailto:me@example.com&quot;</span><span class="kw">&gt;</span>John Doe<span class="kw">&lt;/a&gt;</span></a></code></pre></div>
<p>is rendered as <a href="mailto:me@example.com">John Doe</a> and makes it very clear, to machines and humans alike, that <em>John Doe</em> can be reached at <em>me@example.com</em>. Address munging, like the above, preserves this meaning for humans, but takes it away for machines. For better and for worse, browsers, search engines, and spam bots will not be aware of the meaning of the obfuscated address.</p>
<p>These effects can be alleviated by resolving to additional javascript:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">// convert obfuscated mail addresses into clickable &quot;mailto:&quot; links</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="at">jQuery</span>(<span class="st">&quot;document&quot;</span>).<span class="at">ready</span>(<span class="kw">function</span>($) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="kw">var</span> mailAddressClass <span class="op">=</span> <span class="st">&quot;obfuscated-mail-address&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  <span class="at">$</span>(<span class="st">&quot;.&quot;</span><span class="op">+</span>mailAddressClass).<span class="at">each</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">    <span class="kw">var</span> address <span class="op">=</span> <span class="at">$</span>(<span class="kw">this</span>).<span class="at">attr</span>(<span class="st">&quot;data-user&quot;</span>) <span class="op">+</span> <span class="st">&quot;@&quot;</span> <span class="op">+</span> <span class="at">$</span>(<span class="kw">this</span>).<span class="at">attr</span>(<span class="st">&quot;data-domain&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    <span class="at">$</span>(<span class="kw">this</span>).<span class="at">html</span>(<span class="at">$</span>(<span class="st">&quot;&lt;a href=</span><span class="sc">\&quot;</span><span class="st">mailto:&quot;</span> <span class="op">+</span> address <span class="op">+</span> <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st">&gt;&quot;</span> <span class="op">+</span> address <span class="op">+</span> <span class="st">&quot;&lt;/a&gt;&quot;</span><span class="op">,</span> <span class="op">{}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    <span class="at">$</span>(<span class="kw">this</span>).<span class="at">removeClass</span>(mailAddressClass)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The webpage is still usable with JavaScript turned off, and even fails gracefully on text-only browsers. If JavaScript is available, the obfuscated links offer the same experience as properly coded <code>&lt;a href=&quot;mailto:...&quot;&gt;...&lt;/a&gt;</code> links: <span class="obfuscated-mail-address" data-user="john.doe" data-domain="example.com">@</span>. I believe this to be a very good trade-off between usability and safety from harvesters.</p>
  </div>
</article>

      </div>
    </div>

    <footer>
      <div class="container"
           vocab="http://purl.org/dc/terms/">
        <div id="copyright-info">
          <span class="inline-logo"><svg viewBox="0 0 212 212"
     xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    
  </defs>
  <rect class="logo-background"
        width="100%"
        height="100%" />
  <g transform="translate(100 100)">
    <!-- hours -->
    <g class="logo-hour-dial" transform="rotate(310)">
      <rect class="dial"
            x="-11"
            y="-50"
            width="22"
            height="50"
            ry="16px"/>
    </g>
    <!-- minutes -->
    <g class="logo-minute-dial" transform="rotate(60)">
      <rect class="dial"
            x="-10"
            y="-70"
            width="20"
            height="70"
            ry="14px"/>
    </g>
    <!-- seconds -->
    <g class="logo-second-dial" transform="rotate(200)">
      <circle class="centerpiece"
              cx="0"
              cy="0"
              r="2"/>
      <rect class="dial"
            x="-2"
            y="-73"
            width="4"
            height="73"
            ry="5px"/>
    </g>
    <!-- clock center -->
    <circle class="logo-centerpiece"
            cx="0"
            cy="0"
            r="15"/>
  </g>
  <g class="logo-lupe"
     transform="translate(100 100) rotate(45)">
    <!-- lens -->
    <circle class="logo-lens"
            cx="0"
            cy="0"
            r="86"
            fill="none"
            stroke-width="26px" />
    <!-- handle -->
    <rect class="logo-handle"
          x="90"
          y="-30px"
          width="40"
          height="60px"
          rx="5px"/>
  </g>
  
</svg>
</span>
          <span property="title">ZeitKraut</span>,
          <span class="copyright-notice">
            Copyright © 2013–2018
            <a href="/contact.html#content"
               property="http://creativecommons.org/ns#attributionName"
               rel="http://creativecommons.org/ns#attributionURL">Albert
               Krewinkel</a>.
          </span>
        </div>
        <div id="legal-info">
          Text is available under the
          <a rel="license"
             href="http://creativecommons.org/licenses/by-sa/3.0/de/deed.en_US">
            <abbr title="Creative Commons Attribution-ShareAlike 3.0 Germany">
              CC BY‑SA 3.0 DE</abbr></a> license.
        </div>
        <div id="feed-and-code">
          Read the <a href="/atom.xml">feed <span class="fa fa-rss"></span></a> or
          grab the
          <a href="https://github.com/tarleb/zeitkraut-blog"
             >code <span class="fa fa-github"></span></a>!
        </div>
      </div>
    </footer>
    <script type="text/javascript" src="/scripts/jquery.min.js"></script>
    <script type="text/javascript" src="/scripts/bootstrap.min.js"></script>
  </body>
</html>
